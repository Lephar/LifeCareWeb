<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="Ayarlar">
		<meta name="author" content="Qwerty Tasarım ve Bilgi Teknolojileri">
		<title>Ayarlar</title>

		<!-- Bootstrap core CSS -->
		<link href="diyetisyen_paneli/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">

		<!-- Custom fonts for this template -->
		<link href="diyetisyen_paneli/assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <link href="diyetisyen_paneli/assets/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css">

		<!-- Custom fonts for this template -->
		<link href="diyetisyen_paneli/assets/plugins/themify/css/themify.css" rel="stylesheet" type="text/css">

		<!-- Angular Tooltip Css -->
		<link href="diyetisyen_paneli/assets/plugins/angular-tooltip/angular-tooltips.css" rel="stylesheet">

		<!-- Page level plugin CSS -->
		<link href="diyetisyen_paneli/css/animate.css" rel="stylesheet">

		<!-- Custom styles for this template -->
		<link href="diyetisyen_paneli/css/glovia.css" rel="stylesheet">
		<link href="diyetisyen_paneli/css/glovia-responsive.css" rel="stylesheet">

		<!-- Custom styles for Color -->
		<link href="diyetisyen_paneli/css/skins/default.css" rel="stylesheet">
	</head>

	<body class="fixed-nav sticky-footer" id="page-top">

    <div id="nav-placeholder">

    </div>

		<div class="content-wrapper">
			<div class="container-fluid">

				<!-- Title & Breadcrumbs-->
				<div class="row page-titles">
					<div class="col-md-12 align-self-center">
						<h4 class="theme-cl">Ayarlar</h4>
					</div>
				</div>
				<!-- Title & Breadcrumbs-->

				<div class="row">
					<div class="col-md-12">
						<div class="card">
							<div class="row">
								<!-- col-md-6 -->
								<div class="col-md-6 col-12">

									<!-- <div class="flexbox ml-4 mt-4">
										<label class="toggler toggler-danger">
											<input id="photo_upload" type="file">
											<i class="fa fa-upload"></i>
										</label>
									</div>
									<div class="form-group">
										<div class="contact-img">
											<img id="user_photo" src="" class="img-circle img-responsive">
										</div>
									</div> -->

									<div class="contact-box">
										<div class="flexbox ml-4">
											<label class="toggler toggler-danger">
												<input id="photo_upload" type="file">
												<i class="fa fa-upload"></i>
											</label>
										</div>
										<div class="contact-img">
											<img id="user_photo" src="" class="img-circle img-responsive" alt="">
										</div>
										<div class="contact-caption">
											<h4>Daniel Duke</h4>
											<span>danieldwike@hotmail.com</span>
										</div>
										<div id="address_city_country" class="contact-action" style="display: block">
											<i class="fa fa-map-marker" aria-hidden="true"></i> Ankara
										</div>
										<div id="telephone" class="contact-action" style="display: block">
											<i class="fa fa-phone" aria-hidden="true"></i> Ankara
										</div>
										<div id="birth_date" class="contact-action" style="display: block">
											<i class="fa fa-birthday-cake" aria-hidden="true"></i> 07-12-2018
										</div>
										<div id="gender" class="contact-action" style="display: block">
											<i class="fa fa-intersex" aria-hidden="true"></i> Ankara
										</div>
									</div>

									<div class="col-md-12">

										<div class="row">

										</div>

									</div>

									<!-- <div class="col-md-12">
										<div class="form-group">
											<label>Şifre</label>
											<input id="password" type="text" class="form-control">
										</div>
									</div> -->

									<div class="col-md-12">
										<div class="form-group">
											<label>Email</label>
											<input type="text" class="form-control" value="Email" disabled>
										</div>
									</div>

									<div class="col-md-12">
										<div class="form-group">
											<label>Telefon</label>
											<input id="phone" type="text" class="form-control" value="Telefon">
										</div>
									</div>

									<div class="col-md-12">
										<div class="form-group">
											<label>Adres</label>
											<input id="address" type="text" class="form-control" value="Adres">
										</div>
									</div>

									<div class="col-md-12">
										<div class="form-group">
											<label>Ülke</label>

											<select class="custom-select mb-2 form-control" id="country">
														<?php include '../includes/countries.php'; ?>
										    </select>

										</div>
									</div>

									<!-- col-md-12 -->
									<div class="col-md-12">

										<div class="row">
											<div class="col-md-6 col-12">
												<div class="form-group">
													<label>Cinsiyet</label>
													<select class="custom-select mb-2 form-control" id="genderselect">
													    <option default></option>
														<option value="M" <?php if($_SESSION['user']['sex'] == 'M'){echo "selected";} ?>><?php echo $settings['male']; ?></option>
														<option value="F" <?php if($_SESSION['user']['sex'] == 'F'){echo "selected";} ?>><?php echo $settings['female']; ?></option>
													</select>
												</div>
											</div>

											<div class="col-md-6 col-12">
												<div class="form-group">
													<label><?php echo $settings['lang']; ?></label>

													<select  onchange="languageselected()" class="custom-select mb-2 form-control" id="langselect" multiple>
														<?php include '../includes/languages.php'; ?>
														</select>
												</div>
											</div>
										</div>

									</div>
									<!-- col-md-12 -->

									<!-- col-md-12 -->
									<div class="col-md-12">
										<div class="form-group">
											<label>Mezun Olunan Okul</label>
											<input type="text" class="form-control" value="Mezun Olunan Okul" disabled>
										</div>
									</div>
									<!-- col-md-12 -->

									<!-- col-md-12 -->
									<div class="col-md-12">
										<div class="form-group">
											<label>Mezuniyet Yılı</label>
											<input type="text" class="form-control" value="Mezuniyet Yılı" disabled>
										</div>
									</div>
									<!-- col-md-12 -->

									<!-- col-md-12 -->
									<div class="col-md-12">
										<div class="form-group">
											<label>Diploma No</label>
											<input type="text" class="form-control" value="Diploma No" disabled>
										</div>
									</div>
									<!-- col-md-12 -->


								</div>

								<!-- col-md-6 -->
								<div class="col-md-6 col-12 padd-top-20">

									<div class="col-md-11">

										<div class="row">
											<label>Şifremi Değiştir</label>
											<form autocomplete="on" method="post" onsubmit="event.preventDefault();">
												<div class="form-group help">
													<input class="form-control" id="password" type="password" pattern="(?=.*\d)(?=.*[A-z]).{8,}" placeholder="Şifre" value="" required/>
													<small class="text-muted">
							              (Şifreniz en az 8 karakterden oluşmalı, en az bir harf ve en az bir rakam içermelidir.)
							            </small>
												</div>

												<div class="form-group help">
													<input class="form-control" id="confirm_password" type="password" placeholder="Şifre (Tekrar)" value="" required/>
													<small class="text-muted" id="notmatched" style="display:none;">
							              Şifreler eşleşmemektedir.
							            </small>
												</div>

												<div class="form-group">
													<div class="flexbox align-items-center">
														<input type="submit" name="send" class="btn gredient-bg-login" id="register_button" value="Şifremi Değiştir"></input>
													</div>
												</div>
											</form>

										</div>

										<br>


										<!-- <div class="col-md-12"> -->

											<div class="row">
												<label>Sosyal Ağ</label>
												<form autocomplete="on" method="post" onsubmit="event.preventDefault();">
													<div class="form-group">
														<label>Facebook</label>
														<input id="facebook" type="text" class="form-control" placeholder="Facebook">
													</div>

													<div class="form-group">
														<label>Twitter</label>
														<input id="twitter" type="text" class="form-control" placeholder="Twitter">
													</div>

													<div class="form-group">
														<label>Linkedin</label>
														<input id="linkedin" type="text" class="form-control" placeholder="Linkedin">
													</div>

													<div class="form-group">
														<label>Instagram</label>
														<input id="instagram" type="text" class="form-control" placeholder="Instagram">
													</div>

													<div class="form-group">
														<div class="flexbox align-items-center">
															<input type="submit" name="send" class="btn gredient-bg-login" id="register_button" value="Kaydet"></input>
														</div>
													</div>

												</form>
											</div>

										<!-- </div> -->
									</div>

								</div>

							</div>
						</div>


						<center><p id="errortext" style="color:red;"><?php if($row['listing'] == 0){ echo $settings['notready']; } ?></p></center>
						<!--  Save Button -->
							<div class="row">
								<div class="col-md-12">
									<div class="text-center">
										<div class="text-center padd-bot-20" >
											<a class="btn outline-secondary bg-white-save" onclick="save()">Kaydet</a>
										</div>
									</div>
								</div>
							</div>


					</div>
				</div>

			</div>
			<!-- /.content-wrapper-->

			<!-- Footer -->
			<footer class="sticky-footer">
			  <div class="container">
				<div class="text-center">
				   <small class="font-15">Copyright © <img class="img-responsive" src="diyetisyen_paneli/img/qwerty-01.png" alt="Logo Qwerty"></small>
				</div>
			  </div>
			</footer>

			<!-- Scroll to Top Button-->
			<a class="scroll-to-top rounded cl-white gredient-bg" href="#page-top">
			  <i class="ti-angle-double-up"></i>
			</a>

			<!-- Bootstrap core JavaScript-->
			<script src="diyetisyen_paneli/assets/plugins/jquery/jquery.min.js"></script>
			<script src="diyetisyen_paneli/assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

			<!-- Core plugin JavaScript-->
			<script src="diyetisyen_paneli/assets/plugins/jquery-easing/jquery.easing.min.js"></script>

			 <!-- Slick Slider Js -->
			<script src="diyetisyen_paneli/assets/plugins/slick-slider/slick.js"></script>

			<!-- Slim Scroll -->
			<script src="diyetisyen_paneli/assets/plugins/slim-scroll/jquery.slimscroll.min.js"></script>
			<!-- <script src="libs/select2/js/select2.min.js"></script> -->
			<!-- Angular Tooltip -->
			<script src="diyetisyen_paneli/assets/plugins/angular-tooltip/angular.js"></script>
			<script src="diyetisyen_paneli/assets/plugins/angular-tooltip/angular-tooltips.js"></script>
			<script src="diyetisyen_paneli/assets/plugins/angular-tooltip/index.js"></script>
			<!-- <script src="libs/antixss/javascript/Reform.js"></script> -->
			<!-- <script src="libs/js/ajaxsender.js"></script> -->
			<!-- Custom scripts for all pages-->
			<script src="diyetisyen_paneli/js/glovia.js"></script>
			<script src="diyetisyen_paneli/assets/plugins/validator/validator.js"></script>

			<script>
			  $('.dropdown-toggle').dropdown()
			  </script>

	  </div>
	  <!-- Wrapper -->

		<script src="diyetisyen_paneli/js/custom/navbar_script.js"></script>

		<script src="https://www.gstatic.com/firebasejs/5.5.1/firebase.js"></script>
		<script>
			// Initialize Firebase
			var config = {
				apiKey: "AIzaSyA24Eyjeh0HipNlMBhAJRnacsFxAySHgtY",
				authDomain: "lifecare-55c38.firebaseapp.com",
				databaseURL: "https://lifecare-55c38.firebaseio.com",
				projectId: "lifecare-55c38",
				storageBucket: "lifecare-55c38.appspot.com",
				messagingSenderId: "340270538259"
			};
			firebase.initializeApp(config);
		</script>

		<script>
			$(function(){
				$("#nav-placeholder").load("navbar.html");
			});
		</script>

		<script>

			var password = document.getElementById("password");
			var confirm_password = document.getElementById("confirm_password");
			function validatePassword()
			{
				password.reportValidity();
				document.getElementById("notmatched").style.display = "none";
				if(password.value != confirm_password.value) {
					confirm_password.setCustomValidity("Şifreler Eşleşmiyor");
					document.getElementById("notmatched").style.display = "block";
					return false;
				} else {
					confirm_password.setCustomValidity("");
					return true;
				}
			};
			password.onkeyup = validatePassword;
			confirm_password.onkeyup = validatePassword;

			function upload_profile_photo(user)
			{
				document.getElementById("photo_upload").onchange = function(event)
				{
					console.log("here");
					var uploaded_file = document.getElementById("photo_upload").files[0];
					var metadata = {
						contentType: 'image/jpeg'
					};
					var storageRef = firebase.storage().ref("WebUsers/" + user.uid);
					storageRef.put(uploaded_file, metadata).then(function()
					{
						storageRef.getDownloadURL().then(function(url)
						{
							user.updateProfile(
							{
								photoURL: url
							}).then(function()
							{
								var updates = {};
								updates['/photo_url'] = url;
								firebase.database().ref("WebUsers/UserInfos/" + user.uid).update(updates);
							});
							console.log(url);
						});
					});
				}
			}

			function put_user_infos(user)
			{
				document.getElementById("user_photo").src = user.photoURL;
			}

			firebase.auth().onAuthStateChanged(function(user)
			{
				if (user)
				{
					nav_bar_part_of_the_page(user);
					fill_message_box(user);
					upload_profile_photo(user);
					put_user_infos(user);
				}
				else
				{
					document.location.replace("login.html");
				}
			});
		</script>
	</body>
</html>


<!-- <script>


function readTextFile(file,type,lang)
{
    var rawFile = new XMLHttpRequest();
    rawFile.open("GET", file, true);
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
                var allText = rawFile.responseText;

				if(allText != undefined){

					document.getElementById(type+lang).value = allText;

				}



            }
        }
    }
    rawFile.send(null);
}





var selectedlanguages = new Array();

languageselected();
function languageselected(){

 selectedlanguages = $('#langselect').val();


	if(selectedlanguages.length>0){

	document.getElementById('langcontent').innerHTML = '<li class="active"><a data-toggle="tab" href="#'+selectedlanguages[0]+'">'+$("#langselect option[value='"+selectedlanguages[0]+"']").text()+'</a></li>';






	document.getElementById('langcontenttabs').innerHTML = '<div id="'+selectedlanguages[0]+'" class="tab-pane fade in active">'+
  	'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['skills']; ?>('+selectedlanguages[0]+')</label>'+
											'<input id="skills'+selectedlanguages[0]+'" type="text" class="form-control" placeholder="" value="">'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['aboutme']; ?>('+selectedlanguages[0]+')</label>'+
											'<textarea id="aboutme'+selectedlanguages[0]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['education']; ?>('+selectedlanguages[0]+')</label>'+
											'<textarea id="education'+selectedlanguages[0]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['experience']; ?>('+selectedlanguages[0]+')</label>'+
											'<textarea id="experience'+selectedlanguages[0]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['attended']; ?>('+selectedlanguages[0]+')</label>'+
											'<textarea id="attended'+selectedlanguages[0]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

  '</div>';
	 readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[0]+'_skills_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','skills',selectedlanguages[0]);
	 readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[0]+'_education_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','education',selectedlanguages[0]);
	 readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[0]+'_experience_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','experience',selectedlanguages[0]);
	 readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[0]+'_attended_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','attended',selectedlanguages[0]);
     readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[0]+'_aboutme_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','aboutme',selectedlanguages[0]);











	for(var i=1 ; i<(selectedlanguages.length) ; i++){

		document.getElementById('langcontent').innerHTML += '<li><a data-toggle="tab" href="#'+selectedlanguages[i]+'">'+$("#langselect option[value='"+selectedlanguages[i]+"']").text()+'</a></li>';




	document.getElementById('langcontenttabs').innerHTML += '<div id="'+selectedlanguages[i]+'" class="tab-pane fade">'+
  	'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['skills']; ?>('+selectedlanguages[i]+')</label>'+
											'<input id="skills'+selectedlanguages[i]+'" type="text" class="form-control" placeholder="" value="">'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['aboutme']; ?>('+selectedlanguages[i]+')</label>'+
											'<textarea id="aboutme'+selectedlanguages[i]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['education']; ?>('+selectedlanguages[i]+')</label>'+
											'<textarea id="education'+selectedlanguages[i]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['experience']; ?>('+selectedlanguages[i]+')</label>'+
											'<textarea id="experience'+selectedlanguages[i]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

									'<div class="col-md-12">'+
										'<div class="form-group">'+
											'<label><?php echo $settings['attended']; ?>('+selectedlanguages[i]+')</label>'+
											'<textarea id="attended'+selectedlanguages[i]+'" rows="4" type="text" class="form-control" placeholder="" value=""></textarea>'+
										'</div>'+
									'</div>'+

  '</div>';


	readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[i]+'_skills_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','skills',selectedlanguages[i]);
	readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[i]+'_education_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','education',selectedlanguages[i]);
	readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[i]+'_experience_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','experience',selectedlanguages[i]);
	readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[i]+'_attended_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','attended',selectedlanguages[i]);
    readTextFile('<?php echo $url; ?>/usercontents/'+selectedlanguages[i]+'_aboutme_<?php echo $_SESSION['user']['user_id'].".txt"; ?>','aboutme',selectedlanguages[i]);

	}


	}else{

		document.getElementById('langcontent').innerHTML = '<li class="active"><a data-toggle="tab"><?php echo $settings['lutfendilsecin']; ?></a></li>';

		document.getElementById('langcontenttabs').innerHTML = '';
	}

}






$(document).ready(function() {
    $('#langselect').select2();
});




function save(){

	if(selectedlanguages.length<1){


		document.getElementById('errortext').innerHTML =  "<?php echo $settings['lutfendilsecin']; ?>";


		return;
	}





  var fd = new FormData();
  var other ={};
    var c=0;
    var file_data;
    $('input[type="file"]').each(function(){
        file_data = $('input[type="file"]')[c].files; // for multiple files

     for(var i = 0;i<file_data.length;i++){
         fd.append("file_"+c, file_data[i]);
     }
    c++;
 });

    var other = {};
	for(var i = 0; i<selectedlanguages.length;i++){
		other[selectedlanguages[i]] = {
		'skills':document.getElementById('skills'+selectedlanguages[i]).value,
		'aboutme':document.getElementById('aboutme'+selectedlanguages[i]).value,
		'education':document.getElementById('education'+selectedlanguages[i]).value,
		'experience':document.getElementById('experience'+selectedlanguages[i]).value,
		'attended':document.getElementById('attended'+selectedlanguages[i]).value,
		};

	}

	other['country'] = $('#country').val();
	other['sex']= $('#genderselect').val();
	other['phone'] = document.getElementById('phone').value;
	other['address'] = document.getElementById('address').value;
	other['face']=document.getElementById('face').value;
	other['twitter']=document.getElementById('twitter').value;
	other['linkedin']=document.getElementById('linkedin').value;
	other['instagram']=document.getElementById('instagram').value;



	 fd.append("data",JSON.stringify(other));


	 var ajaxsender = new MultipartAjaxSender("POST","<?php echo $url; ?>/ajax/settings.php",fd);
     ajaxsender.send(function(response){

	 response = JSON.parse(response);
	 response = response['cevap'];
	if(response == "listed"){


		document.getElementById('errortext').innerHTML =  "<?php echo $settings['listed']; ?>";

	}else if(response == "notlisted"){

		document.getElementById('errortext').innerHTML =  "<?php echo $settings['notlisted']; ?>";



	}else{

		document.getElementById('errortext').innerHTML =  response;


	}



 });

}



       $(function() {
    $('#profile-pic').on('click', function() {
        $('#profile-image-upload').click();
    });
});


	function readURL(input) {

              if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function(e) {
                  $('#profile-pic').attr('src', e.target.result);
                }

                reader.readAsDataURL(input.files[0]);
              }
            }

            $("#profile-image-upload").change(function() {
              readURL(this);
            });





</script> -->
